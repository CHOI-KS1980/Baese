# Make.comì„ í™œìš©í•œ Gë¼ì´ë” ë¯¸ì…˜ ìë™ ì „ì†¡ ì‹œìŠ¤í…œ - ì™„ì „ ì´ˆë³´ì ê°€ì´ë“œ

## ğŸš¨ ì´ ê°€ì´ë“œëŠ” ì»´í“¨í„° ì´ˆë³´ìë„ ë”°ë¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

### âš ï¸ ì¤€ë¹„ì‚¬í•­
- ì»´í“¨í„° (Windows ë˜ëŠ” Mac)
- ì¸í„°ë„· ì—°ê²°
- ì´ë©”ì¼ ì£¼ì†Œ 1ê°œ
- 30ë¶„ ì •ë„ì˜ ì‹œê°„

---

## ğŸ“‹ **1ë‹¨ê³„: Make.com íšŒì›ê°€ì…í•˜ê¸°**

### 1-1. ì›¹ì‚¬ì´íŠ¸ ì ‘ì†í•˜ê¸°
1. **ì¸í„°ë„· ë¸Œë¼ìš°ì € ì—´ê¸°** (í¬ë¡¬, ì—£ì§€, ì‚¬íŒŒë¦¬ ë“±)
2. **ì£¼ì†Œì°½ì— ì…ë ¥**: `https://www.make.com` 
3. **Enter í‚¤ ëˆ„ë¥´ê¸°**

### 1-2. íšŒì›ê°€ì…í•˜ê¸°
1. **í™”ë©´ì—ì„œ "Get started free" ë²„íŠ¼ ì°¾ê¸°** (ë³´í†µ ì˜¤ë¥¸ìª½ ìƒë‹¨ì— ìˆìŒ)
2. **"Get started free" ë²„íŠ¼ í´ë¦­**
3. **ì´ë©”ì¼ ì£¼ì†Œ ì…ë ¥**: ë³¸ì¸ì˜ ì´ë©”ì¼ ì£¼ì†Œ íƒ€ì´í•‘
4. **ë¹„ë°€ë²ˆí˜¸ ì…ë ¥**: 8ì ì´ìƒ, ì˜ë¬¸+ìˆ«ì ì¡°í•©
5. **"Create account" ë²„íŠ¼ í´ë¦­**
6. **ì´ë©”ì¼ í™•ì¸**: ë°›ì€ ë©”ì¼í•¨ í™•ì¸ í›„ ì¸ì¦ ë§í¬ í´ë¦­

### 1-3. ì²« ì‹œë‚˜ë¦¬ì˜¤ ë§Œë“¤ê¸°
1. **ë¡œê·¸ì¸ ì™„ë£Œ í›„ ëŒ€ì‹œë³´ë“œì—ì„œ**
2. **"Create scenario" ë²„íŠ¼ ì°¾ê¸°** (í° íŒŒë€ìƒ‰ ë²„íŠ¼)
3. **"Create scenario" ë²„íŠ¼ í´ë¦­**
4. **íŒì—…ì°½ì´ ë‚˜íƒ€ë‚˜ë©´**:
   - **"Scenario name" ì¹¸ì— ì…ë ¥**: `Gë¼ì´ë” ë¯¸ì…˜ ìë™ ì „ì†¡`
   - **"Create" ë²„íŠ¼ í´ë¦­**

---

## â° **2ë‹¨ê³„: ìŠ¤ì¼€ì¤„ ì„¤ì •í•˜ê¸°**

### 2-1. Schedule ëª¨ë“ˆ ì¶”ê°€í•˜ê¸°
1. **í™”ë©´ ê°€ìš´ë° í° "+" ë²„íŠ¼ ë³´ì´ì£ ?**
2. **ê·¸ "+" ë²„íŠ¼ í´ë¦­**
3. **ì™¼ìª½ì— ì•± ëª©ë¡ì´ ë‚˜íƒ€ë‚©ë‹ˆë‹¤**
4. **ê²€ìƒ‰ì°½ (ìƒë‹¨)ì— `Schedule` íƒ€ì´í•‘**
5. **"Schedule" ì•„ì´ì½˜ í´ë¦­** (ì‹œê³„ ëª¨ì–‘)
6. **"Schedule" ëª¨ë“ˆ í´ë¦­**

### 2-2. ìŠ¤ì¼€ì¤„ ê¸°ë³¸ ì„¤ì •
1. **ì„¤ì • ì°½ì´ ì—´ë ¸ì£ ?**
2. **"Interval" ë“œë¡­ë‹¤ìš´ í´ë¦­**
3. **"Every N hours" ì„ íƒ**
4. **"Hours" ì¹¸ì— `4` ì…ë ¥** (4ì‹œê°„ë§ˆë‹¤)
5. **"Time zone" ë“œë¡­ë‹¤ìš´ í´ë¦­**
6. **"Asia/Seoul" ì°¾ì•„ì„œ í´ë¦­**

### 2-3. ê³ ê¸‰ ìŠ¤ì¼€ì¤„ë§ ì„¤ì • (ì •í™•í•œ ì‹œê°„ ì„¤ì •)
1. **ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•´ì„œ "Advanced scheduling" ì°¾ê¸°**
2. **"Advanced scheduling" ì™¼ìª½ í™”ì‚´í‘œ í´ë¦­** (í¼ì¹˜ê¸°)
3. **"Add item" ë²„íŠ¼ í´ë¦­**
4. **"Time from" ì¹¸ì— `08:00` ì…ë ¥**
5. **"Time to" ì¹¸ì— `08:05` ì…ë ¥**
6. **"Days" ì„¹ì…˜ì—ì„œ ëª¨ë“  ìš”ì¼ ì²´í¬** (ì›”í™”ìˆ˜ëª©ê¸ˆí† ì¼)
7. **"Months" ì„¹ì…˜ì—ì„œ ëª¨ë“  ì›” ì²´í¬** (1~12ì›”)

### 2-4. ì¶”ê°€ ì‹œê°„ëŒ€ ì„¤ì •í•˜ê¸°
**ê°™ì€ ë°©ë²•ìœ¼ë¡œ 6ë²ˆ ë” ë°˜ë³µí•˜ì„¸ìš”:**

**2ë²ˆì§¸ ì‹œê°„ (10:30):**
- **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
- **"Time from": `10:30`**
- **"Time to": `10:35`**
- **ìš”ì¼ê³¼ ì›” ëª¨ë‘ ì²´í¬**

**3ë²ˆì§¸ ì‹œê°„ (12:00):**
- **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
- **"Time from": `12:00`**
- **"Time to": `12:05`**
- **ìš”ì¼ê³¼ ì›” ëª¨ë‘ ì²´í¬**

**4ë²ˆì§¸ ì‹œê°„ (14:30):**
- **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
- **"Time from": `14:30`**
- **"Time to": `14:35`**
- **ìš”ì¼ê³¼ ì›” ëª¨ë‘ ì²´í¬**

**5ë²ˆì§¸ ì‹œê°„ (18:00):**
- **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
- **"Time from": `18:00`**
- **"Time to": `18:05`**
- **ìš”ì¼ê³¼ ì›” ëª¨ë‘ ì²´í¬**

**6ë²ˆì§¸ ì‹œê°„ (20:30):**
- **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
- **"Time from": `20:30`**
- **"Time to": `20:35`**
- **ìš”ì¼ê³¼ ì›” ëª¨ë‘ ì²´í¬**

**7ë²ˆì§¸ ì‹œê°„ (22:00):**
- **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
- **"Time from": `22:00`**
- **"Time to": `22:05`**
- **ìš”ì¼ê³¼ ì›” ëª¨ë‘ ì²´í¬**

### 2-5. ì„¤ì • ì™„ë£Œ
1. **ëª¨ë“  ì„¤ì •ì´ ëë‚˜ë©´**
2. **ì˜¤ë¥¸ìª½ ì•„ë˜ "OK" ë²„íŠ¼ í´ë¦­**

---

## ğŸŒ **3ë‹¨ê³„: HTTP ëª¨ë“ˆ ì¶”ê°€í•˜ê¸° (ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°)**

### 3-1. HTTP ëª¨ë“ˆ ì¶”ê°€
1. **Schedule ëª¨ë“ˆ ì˜¤ë¥¸ìª½ì— ìˆëŠ” ì‘ì€ ë™ê·¸ë€ ì•„ì´ì½˜ ë³´ì´ì‹œì£ ?**
2. **ê·¸ ë™ê·¸ë€ ì•„ì´ì½˜ í´ë¦­** (+ ëª¨ì–‘)
3. **ê²€ìƒ‰ì°½ì— `HTTP` íƒ€ì´í•‘**
4. **"HTTP" ì•± í´ë¦­**
5. **"Make a request" í´ë¦­**

### 3-2. HTTP ê¸°ë³¸ ì„¤ì •
1. **"URL" ì¹¸ í´ë¦­**
2. **ë‹¤ìŒ ì£¼ì†Œë¥¼ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°**:
```
https://jangboo.grider.ai/
```

3. **"Method" ë“œë¡­ë‹¤ìš´ì´ "GET"ìœ¼ë¡œ ë˜ì–´ìˆëŠ”ì§€ í™•ì¸** (ì•ˆë˜ì–´ìˆìœ¼ë©´ GET ì„ íƒ)
4. **"Parse response" ì²´í¬ë°•ìŠ¤ê°€ ì²´í¬ë˜ì–´ìˆëŠ”ì§€ í™•ì¸** (ì•ˆë˜ì–´ìˆìœ¼ë©´ ì²´í¬)

### 3-3. Headers ì¶”ê°€í•˜ê¸° (ì™„ì „ ë²„ì „)
1. **ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•´ì„œ "Headers" ì„¹ì…˜ ì°¾ê¸°**
2. **"Add item" ë²„íŠ¼ í´ë¦­**
3. **ì²« ë²ˆì§¸ Header ì¶”ê°€**:
   - **"Key" ì¹¸ì— ì…ë ¥**: `User-Agent`
   - **"Value" ì¹¸ì— ë‹¤ìŒì„ ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°**:
   ```
   Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
   ```

4. **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
5. **ë‘ ë²ˆì§¸ Header ì¶”ê°€**:
   - **"Key" ì¹¸ì— ì…ë ¥**: `Accept`
   - **"Value" ì¹¸ì— ì…ë ¥**: `text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8`

6. **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
7. **ì„¸ ë²ˆì§¸ Header ì¶”ê°€**:
   - **"Key" ì¹¸ì— ì…ë ¥**: `Accept-Language`
   - **"Value" ì¹¸ì— ì…ë ¥**: `ko-KR,ko;q=0.9,en;q=0.8`

8. **"Add item" ë²„íŠ¼ ë‹¤ì‹œ í´ë¦­**
9. **ë„¤ ë²ˆì§¸ Header ì¶”ê°€**:
   - **"Key" ì¹¸ì— ì…ë ¥**: `Accept-Encoding`
   - **"Value" ì¹¸ì— ì…ë ¥**: `gzip, deflate, br`

### ğŸš¨ **ConnectionError í•´ê²° ë°©ë²•:**

#### **ë°©ë²• 1: ëŒ€ì²´ URL ì‚¬ìš©**
ë§Œì•½ ì›ë³¸ ì‚¬ì´íŠ¸ê°€ ì•ˆ ë˜ë©´ **í…ŒìŠ¤íŠ¸ìš© URL**ë¡œ ë°”ê¿”ë³´ì„¸ìš”:
1. **URL ì¹¸ì˜ ë‚´ìš©ì„ ëª¨ë‘ ì‚­ì œ**
2. **ë‹¤ìŒ ì¤‘ í•˜ë‚˜ë¥¼ ì…ë ¥**:
```
https://httpbin.org/html
```
ë˜ëŠ”
```
https://jsonplaceholder.typicode.com/posts/1
```

#### **ë°©ë²• 2: ê³ ê¸‰ ì„¤ì • ë³€ê²½**
1. **ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•´ì„œ ê³ ê¸‰ ì„¤ì • ì°¾ê¸°**
2. **"Follow redirect" â†’ trueë¡œ ì„¤ì •**
3. **"Request compressed content" â†’ trueë¡œ ì„¤ì •**
4. **"Timeout" â†’ 30 ì…ë ¥**

### 3-4. ì„¤ì • ì™„ë£Œ
1. **"OK" ë²„íŠ¼ í´ë¦­**

---

## ğŸ”§ **4ë‹¨ê³„: Tools ëª¨ë“ˆ ì¶”ê°€í•˜ê¸° (ë°ì´í„° ë³€í™˜)**

### 4-1. Tools ëª¨ë“ˆ ì¶”ê°€
1. **HTTP ëª¨ë“ˆ ì˜¤ë¥¸ìª½ ë™ê·¸ë€ ì•„ì´ì½˜ í´ë¦­**
2. **ê²€ìƒ‰ì°½ì— `Tools` íƒ€ì´í•‘**
3. **"Tools" ì¹´í…Œê³ ë¦¬ í´ë¦­**
4. **"Set variable" í´ë¦­**

### 4-2. ë³€ìˆ˜ ì´ë¦„ ì„¤ì •
1. **"Variable name" ì¹¸ í´ë¦­**
2. **ë‹¤ìŒì„ ì…ë ¥**: `mission_message`

### 4-3. ì½”ë“œ ì…ë ¥ (ë§¤ìš° ì¤‘ìš”!)
1. **"Value" ì¹¸ í´ë¦­** (í° í…ìŠ¤íŠ¸ ë°•ìŠ¤)
2. **í…ìŠ¤íŠ¸ ë°•ìŠ¤ ì•ˆì˜ ëª¨ë“  ë‚´ìš© ì‚­ì œ** (Ctrl+A í›„ Delete)
3. **ì•„ë˜ ì½”ë“œë¥¼ ì „ì²´ ë³µì‚¬** (Ctrl+A í›„ Ctrl+C):

```javascript
// ğŸš€ Gë¼ì´ë” ë©”ì‹œì§€ ìë™ ìƒì„±ê¸° (ìˆ˜ì •ëœ ë²„ì „)
const htmlData = {{2.data}};  // HTTP ëª¨ë“ˆ 2ë²ˆì˜ ë°ì´í„°

// í˜„ì¬ ë‚ ì§œì™€ ì‹œê°„ ê°€ì ¸ì˜¤ê¸°
const now = new Date();
const dateStr = now.toLocaleDateString('ko-KR');
const timeStr = now.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'});

// ê¸°ë³¸ ë©”ì‹œì§€ í…œí”Œë¦¿
let message = `ğŸš€ Gë¼ì´ë” ë¯¸ì…˜ í˜„í™© ğŸ“Š

ğŸ“… ${dateStr} ${timeStr} ì—…ë°ì´íŠ¸

`;

try {
    // HTMLì—ì„œ ìˆ«ì ì°¾ê¸° (ë¯¸ì…˜ ê°œìˆ˜)
    const numbers = htmlData.match(/\d{1,3}(,\d{3})*/g) || [];
    const missionCount = numbers.length > 0 ? numbers[0] : "ì§‘ê³„ì¤‘";
    
    // HTMLì—ì„œ ì´ë¦„ ì°¾ê¸° (TOP ë¼ì´ë”)
    const namePattern = /ë¼ì´ë”[^0-9]*([ê°€-í£]{2,4})/;
    const nameMatch = htmlData.match(namePattern);
    const topRider = nameMatch ? nameMatch[1] : "ì§‘ê³„ì¤‘";
    
    // ë©”ì‹œì§€ ì™„ì„±
    message += `ğŸ“Š **ë¯¸ì…˜ í˜„í™©**
ì´ ë¯¸ì…˜: ${missionCount}ê±´

ğŸ† **TOP ë¼ì´ë”**
${topRider}ë‹˜

ğŸ’° **ì˜¤ëŠ˜ì˜ í¬ì¸íŠ¸**
í¬ì¸íŠ¸ ì§‘ê³„ì¤‘...

ğŸ¯ í™”ì´íŒ…! ë” ë§ì€ ë¯¸ì…˜ì„ ì™„ì£¼í•˜ì„¸ìš”!
âš¡ ìë™ ì—…ë°ì´íŠ¸ by Gë¼ì´ë”ë´‡`;

} catch (error) {
    // ì—ëŸ¬ê°€ ë‚˜ë©´ ê¸°ë³¸ ë©”ì‹œì§€
    message += `âŒ ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ ë°œìƒ
ë‹¤ìŒ ì—…ë°ì´íŠ¸ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.

ğŸ”„ ìë™ìœ¼ë¡œ ì¬ì‹œë„í•©ë‹ˆë‹¤.`;
}

// ìµœì¢… ë©”ì‹œì§€ ë°˜í™˜
message;
```

4. **í…ìŠ¤íŠ¸ ë°•ìŠ¤ì— ë¶™ì—¬ë„£ê¸°** (Ctrl+V)
5. **"OK" ë²„íŠ¼ í´ë¦­**

---

## ğŸ“¤ **5ë‹¨ê³„: ë‘ ë²ˆì§¸ HTTP ëª¨ë“ˆ (ì¹´ì¹´ì˜¤í†¡ ì „ì†¡)**

### 5-1. ë‘ ë²ˆì§¸ HTTP ëª¨ë“ˆ ì¶”ê°€
1. **Tools ëª¨ë“ˆ ì˜¤ë¥¸ìª½ ë™ê·¸ë€ ì•„ì´ì½˜ í´ë¦­**
2. **ê²€ìƒ‰ì°½ì— `HTTP` íƒ€ì´í•‘**
3. **"HTTP" ì•± í´ë¦­**
4. **"Make a request" í´ë¦­**

### 5-2. ì›¹í›… ì„œë²„ ì„¤ì •
1. **"URL" ì¹¸ì— ë‹¤ìŒì„ ì…ë ¥**: 
```
https://g-rider-webhook.onrender.com/send-kakao
```
**â€» ì£¼ì˜: ì‹¤ì œë¡œëŠ” 6ë‹¨ê³„ì—ì„œ ë§Œë“  ì„œë²„ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤**

2. **"Method" ë“œë¡­ë‹¤ìš´ì—ì„œ "POST" ì„ íƒ**

### 5-3. Headers ì„¤ì •
1. **"Headers" ì„¹ì…˜ì—ì„œ "Add item" í´ë¦­**
2. **"Key" ì¹¸ì— ì…ë ¥**: `Content-Type`
3. **"Value" ì¹¸ì— ì…ë ¥**: `application/json`

### 5-4. Body ì„¤ì • (JSON ë°ì´í„°) - ìµœì‹  ë²„ì „
1. **ì•„ë˜ë¡œ ìŠ¤í¬ë¡¤í•´ì„œ "Body" ì„¹ì…˜ ì°¾ê¸°**
2. **"Body Type" ë“œë¡­ë‹¤ìš´ í´ë¦­**
3. **"Raw" ì„ íƒ**
4. **"Content Type" ë“œë¡­ë‹¤ìš´ í´ë¦­**
5. **"application/json" ì„ íƒ**
6. **"Request content" í…ìŠ¤íŠ¸ ë°•ìŠ¤ê°€ ë‚˜íƒ€ë‚˜ë©´ í´ë¦­**
7. **âš ï¸ ì¤‘ìš”: ë‹¤ìŒ ë‚´ìš©ë§Œ ì…ë ¥ (```jsonì€ ì…ë ¥í•˜ì§€ ë§ˆì„¸ìš”!)**:

```json
{
  "message": "{{3.mission_message}}",
  "chat_id": "gt26QiBg",
  "access_token": "ì—¬ê¸°ì—_ì‹¤ì œ_ì¹´ì¹´ì˜¤_í† í°_ì…ë ¥"
}
```

### ğŸš¨ **JSON ì…ë ¥ì‹œ ì£¼ì˜ì‚¬í•­:**

**âŒ ì˜ëª»ëœ ì˜ˆì‹œ (400 ì—ëŸ¬ ë°œìƒ):**
```
```json
{
  "message": "{{3.mission_message}}",
  "chat_id": "gt26QiBg",
  "access_token": "í† í°"
}
```

**âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ:**
```
{
  "message": "{{3.mission_message}}",
  "chat_id": "gt26QiBg",
  "access_token": "ì—¬ê¸°ì—_ì‹¤ì œ_ì¹´ì¹´ì˜¤_í† í°_ì…ë ¥"
}
```

### ğŸ”¢ **ëª¨ë“ˆ ì°¸ì¡° ë²ˆí˜¸ í™•ì¸:**
- **1ë²ˆ**: Schedule ëª¨ë“ˆ
- **2ë²ˆ**: HTTP (ë°ì´í„° ìˆ˜ì§‘)
- **3ë²ˆ**: Tools (ë°ì´í„° ì²˜ë¦¬) â† **ì´ê²ƒì„ ì°¸ì¡°!**
- **4ë²ˆ**: HTTP (ì „ì†¡)

### ğŸ“± **ì‹¤ì œ í™”ë©´ì—ì„œ ë³´ì´ëŠ” ê²ƒ:**
1. **Body Type**: ë“œë¡­ë‹¤ìš´ ë©”ë‰´ (Raw/Form data/ë“±)
2. **Content Type**: ë“œë¡­ë‹¤ìš´ ë©”ë‰´ (application/json/text/ë“±)  
3. **Request content**: í° í…ìŠ¤íŠ¸ ì…ë ¥ ë°•ìŠ¤

### 5-5. ì„¤ì • ì™„ë£Œ
1. **"OK" ë²„íŠ¼ í´ë¦­**

---

## ğŸŒ **6ë‹¨ê³„: GitHub ì›¹í›… ì„œë²„ ì—…ê·¸ë ˆì´ë“œ**

1. **GitHub ì €ì¥ì†Œ ì ‘ì†**: `https://github.com/ë³¸ì¸ê³„ì •/g-rider-webhook`
2. **app.py íŒŒì¼ í´ë¦­**
3. **ì—°í•„ ì•„ì´ì½˜(Edit this file) í´ë¦­**
4. **ëª¨ë“  ë‚´ìš© ì‚­ì œ** (Ctrl+A â†’ Delete)
5. **ë‹¤ìŒ ì—…ê·¸ë ˆì´ë“œëœ ì½”ë“œ ì „ì²´ ë³µì‚¬ í›„ ë¶™ì—¬ë„£ê¸°**:

```python
from flask import Flask, request, jsonify
import requests
import json
import re
from datetime import datetime

app = Flask(__name__)

@app.route('/')
def home():
    return "ğŸš€ Gë¼ì´ë” ì¹´ì¹´ì˜¤í†¡ ë´‡ì´ ì‘ë™ì¤‘ì…ë‹ˆë‹¤! (v2.0)"

@app.route('/send-kakao', methods=['POST'])
def send_kakao():
    try:
        data = request.json
        
        # ë°ì´í„° ì¶”ì¶œ
        status = data.get('status', '')
        raw_data = data.get('raw_data', '')
        chat_id = data.get('chat_id', '')
        access_token = data.get('access_token', '')
        
        # ê¸°ì¡´ ë°©ì‹ë„ ì§€ì› (í•˜ìœ„ í˜¸í™˜ì„±)
        if not status and data.get('message'):
            message = data.get('message')
        else:
            # ìƒˆë¡œìš´ ë°©ì‹: ì„œë²„ì—ì„œ ë©”ì‹œì§€ ìƒì„±
            message = generate_mission_message(raw_data)
        
        # í•„ìˆ˜ íŒŒë¼ë¯¸í„° í™•ì¸
        if not all([message, chat_id, access_token]):
            return jsonify({
                "error": "í•„ìˆ˜ íŒŒë¼ë¯¸í„°ê°€ ëˆ„ë½ë˜ì—ˆìŠµë‹ˆë‹¤",
                "received": {
                    "message_length": len(message) if message else 0,
                    "chat_id": chat_id,
                    "access_token": f"{access_token[:10]}..." if access_token else ""
                }
            }), 400
        
        # ì¹´ì¹´ì˜¤í†¡ API í˜¸ì¶œ
        kakao_result = send_to_kakao(message, chat_id, access_token)
        
        return jsonify(kakao_result)
            
    except Exception as e:
        return jsonify({
            "error": "ì„œë²„ ë‚´ë¶€ ì˜¤ë¥˜",
            "message": str(e),
            "timestamp": datetime.now().isoformat()
        }), 500

def generate_mission_message(raw_data):
    """HTML ë°ì´í„°ì—ì„œ ë©”ì‹œì§€ ìë™ ìƒì„±"""
    
    # í˜„ì¬ ì‹œê°„
    now = datetime.now()
    date_str = now.strftime('%Y-%m-%d')
    time_str = now.strftime('%H:%M')
    
    # ê¸°ë³¸ ë©”ì‹œì§€
    message = f"""ğŸš€ Gë¼ì´ë” ë¯¸ì…˜ í˜„í™© ğŸ“Š

ğŸ“… {date_str} {time_str} ì—…ë°ì´íŠ¸

"""
    
    # HTMLì—ì„œ ë°ì´í„° ì¶”ì¶œ ì‹œë„
    try:
        if raw_data and isinstance(raw_data, str):
            # ìˆ«ì ì°¾ê¸° (ë¯¸ì…˜ ê°œìˆ˜)
            numbers = re.findall(r'\d{1,3}(?:,\d{3})*', raw_data)
            mission_count = numbers[0] if numbers else "ì§‘ê³„ì¤‘"
            
            # ë¼ì´ë” ì´ë¦„ ì°¾ê¸°
            rider_pattern = r'ë¼ì´ë”[^0-9]*([ê°€-í£]{2,4})'
            rider_match = re.search(rider_pattern, raw_data)
            top_rider = rider_match.group(1) if rider_match else "ì§‘ê³„ì¤‘"
            
            # ë¡œê·¸ì¸ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²´í¬
            if '<script>' in raw_data and 'location.href' in raw_data:
                message += """âŒ **ì‚¬ì´íŠ¸ ì ‘ê·¼ ì œí•œ**
ë¡œê·¸ì¸ì´ í•„ìš”í•œ ìƒíƒœì…ë‹ˆë‹¤.

ğŸ”„ **ë‹¤ìŒ ì—…ë°ì´íŠ¸ì—ì„œ ì¬ì‹œë„**
ì‹œìŠ¤í…œì´ ìë™ìœ¼ë¡œ ì¬ì—°ê²°ì„ ì‹œë„í•©ë‹ˆë‹¤.

ğŸ’¡ **ì„ì‹œ í˜„í™©**
ìˆ˜ë™ í™•ì¸ì´ í•„ìš”í•œ ì‹œì ì…ë‹ˆë‹¤."""
            else:
                message += f"""ğŸ“Š **ë¯¸ì…˜ í˜„í™©**
ì´ ë¯¸ì…˜: {mission_count}ê±´

ğŸ† **TOP ë¼ì´ë”**
{top_rider}ë‹˜

ğŸ’° **ì˜¤ëŠ˜ì˜ í¬ì¸íŠ¸**
í¬ì¸íŠ¸ ì§‘ê³„ì¤‘...

ğŸ¯ í™”ì´íŒ…! ë” ë§ì€ ë¯¸ì…˜ì„ ì™„ì£¼í•˜ì„¸ìš”!"""
        else:
            message += """ğŸ“Š **ë¯¸ì…˜ í˜„í™©**
ì´ ë¯¸ì…˜: ì§‘ê³„ì¤‘

ğŸ† **TOP ë¼ì´ë”**
ì§‘ê³„ì¤‘

ğŸ’° **ì˜¤ëŠ˜ì˜ í¬ì¸íŠ¸**
í¬ì¸íŠ¸ ì§‘ê³„ì¤‘...

ğŸ¯ í™”ì´íŒ…! ë” ë§ì€ ë¯¸ì…˜ì„ ì™„ì£¼í•˜ì„¸ìš”!"""
            
    except Exception as e:
        message += f"""âŒ **ë°ì´í„° ì²˜ë¦¬ ì˜¤ë¥˜**
{str(e)[:50]}...

ğŸ”„ **ìë™ ì¬ì‹œë„**
ë‹¤ìŒ ì—…ë°ì´íŠ¸ë¥¼ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”."""
    
    # ê³µí†µ í‘¸í„°
    message += "\n\nâš¡ ìë™ ì—…ë°ì´íŠ¸ by Gë¼ì´ë”ë´‡"
    
    return message

def send_to_kakao(message, chat_id, access_token):
    """ì¹´ì¹´ì˜¤í†¡ API ì „ì†¡"""
    try:
        url = "https://kapi.kakao.com/v1/api/talk/friends/message/default/send"
        
        headers = {
            "Authorization": f"Bearer {access_token}",
            "Content-Type": "application/x-www-form-urlencoded"
        }
        
        template_object = {
            "object_type": "text", 
            "text": message,
            "link": {
                "web_url": "https://jangboo.grider.ai/",
                "mobile_web_url": "https://jangboo.grider.ai/"
            }
        }
        
        payload = {
            "template_object": json.dumps(template_object),
            "receiver_uuids": f'["{chat_id}"]'
        }
        
        response = requests.post(url, headers=headers, data=payload, timeout=30)
        
        if response.status_code == 200:
            return {
                "status": "success",
                "message": "ì¹´ì¹´ì˜¤í†¡ ì „ì†¡ ì„±ê³µ!",
                "response": response.json(),
                "sent_message": message[:100] + "..." if len(message) > 100 else message
            }
        else:
            return {
                "status": "error", 
                "message": "ì¹´ì¹´ì˜¤í†¡ ì „ì†¡ ì‹¤íŒ¨",
                "error": response.text,
                "status_code": response.status_code
            }
            
    except Exception as e:
        return {
            "status": "error",
            "message": "ì¹´ì¹´ì˜¤í†¡ API í˜¸ì¶œ ì‹¤íŒ¨", 
            "error": str(e)
        }

# í—¬ìŠ¤ì²´í¬ ì—”ë“œí¬ì¸íŠ¸
@app.route('/health')
def health():
    return jsonify({
        "status": "healthy",
        "timestamp": datetime.now().isoformat(),
        "version": "2.0"
    })

if __name__ == '__main__':
    app.run(debug=True, host='0.0.0.0', port=5000)
```

6. **"Commit changes" ë²„íŠ¼ í´ë¦­**
7. **Render.comì—ì„œ ìë™ ì¬ë°°í¬ ëŒ€ê¸°** (5-10ë¶„)

### ğŸ“Š **6ë‹¨ê³„: ìë™í™” í™œì„±í™”**

**ëª¨ë“  í…ŒìŠ¤íŠ¸ê°€ ì„±ê³µí•˜ë©´:**
1. **"Scheduling" í† ê¸€ ON**
2. **ì‹œë‚˜ë¦¬ì˜¤ "Active" ìƒíƒœ í™•ì¸**
3. **ì‹¤ì œ ìŠ¤ì¼€ì¤„ì— ë”°ë¼ ìë™ ì‹¤í–‰ ì‹œì‘**:
   - 08:00, 10:30, 12:00, 14:30, 18:00, 20:30, 22:00

### ğŸ¯ **ìµœì¢… ê²°ê³¼:**

**ì™„ì „ ìë™í™”ëœ Gë¼ì´ë” ë¯¸ì…˜ ì•Œë¦¼ ì‹œìŠ¤í…œ!** ğŸ‰
- âœ… **ì •í•´ì§„ ì‹œê°„ì— ìë™ ì‹¤í–‰**
- âœ… **Gë¼ì´ë” ì‚¬ì´íŠ¸ì—ì„œ ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘**
- âœ… **ì˜ˆìœ ë©”ì‹œì§€ ìë™ ìƒì„±**
- âœ… **ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°© ìë™ ì „ì†¡**
- âœ… **24/7 ë¬´ì¸ ì‘ë™**

---

## ğŸ‰ **ì¶•í•˜í•©ë‹ˆë‹¤!**

**Gë¼ì´ë” ë¯¸ì…˜ ìë™ ì•Œë¦¼ ì‹œìŠ¤í…œì´ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤!** 

ì´ì œ ë§¤ì¼ **08:00, 10:30, 12:00, 14:30, 18:00, 20:30, 22:00**ì— ìë™ìœ¼ë¡œ ë¯¸ì…˜ í˜„í™©ì´ ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ì „ì†¡ë©ë‹ˆë‹¤! ğŸš€

**ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ë¬¼ì–´ë³´ì„¸ìš”!** ğŸ˜Š 

---

## ğŸ”‘ **ë¶€ë¡: ì¹´ì¹´ì˜¤ ì•¡ì„¸ìŠ¤ í† í° ë°œê¸‰ë°›ê¸°**

### ğŸ“‹ **1ë‹¨ê³„: ì¹´ì¹´ì˜¤ ê°œë°œì ê³„ì • ë§Œë“¤ê¸°**

1. **ì¹´ì¹´ì˜¤ ê°œë°œì ì‚¬ì´íŠ¸ ì ‘ì†**: https://developers.kakao.com
2. **"ë¡œê·¸ì¸" í´ë¦­**
3. **ì¹´ì¹´ì˜¤ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸** (ì¼ë°˜ ì¹´ì¹´ì˜¤í†¡ ê³„ì •)
4. **"ê°œë°œì ë“±ë¡" ë²„íŠ¼ í´ë¦­**
5. **ê°œì¸ì •ë³´ ë™ì˜ í›„ ê°œë°œì ë“±ë¡**

### ğŸ“± **2ë‹¨ê³„: ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°**

1. **"ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜" ë©”ë‰´ í´ë¦­**
2. **"ì• í”Œë¦¬ì¼€ì´ì…˜ ì¶”ê°€í•˜ê¸°" ë²„íŠ¼ í´ë¦­**
3. **ì•± ì •ë³´ ì…ë ¥**:
   - **ì•± ì´ë¦„**: `Gë¼ì´ë” ìë™ì•Œë¦¼`
   - **ì‚¬ì—…ìëª…**: `ê°œì¸`
   - **ì¹´í…Œê³ ë¦¬**: `ê¸°íƒ€`
4. **"ì €ì¥" ë²„íŠ¼ í´ë¦­**

### ğŸ”§ **3ë‹¨ê³„: í”Œë«í¼ ì„¤ì •**

1. **ë°©ê¸ˆ ë§Œë“  ì•± í´ë¦­**
2. **ì™¼ìª½ ë©”ë‰´ì—ì„œ "í”Œë«í¼" í´ë¦­**
3. **"Web í”Œë«í¼ ë“±ë¡" í´ë¦­**
4. **ì‚¬ì´íŠ¸ ë„ë©”ì¸ ì…ë ¥**: `http://localhost`
5. **"ì €ì¥" ë²„íŠ¼ í´ë¦­**

### ğŸ’¬ **4ë‹¨ê³„: ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì„¤ì •**

1. **ì™¼ìª½ ë©”ë‰´ì—ì„œ "ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸" í´ë¦­**
2. **"í™œì„±í™” ì„¤ì •" â†’ ONìœ¼ë¡œ ë³€ê²½**
3. **"Redirect URI ë“±ë¡" í´ë¦­**
4. **Redirect URI ì…ë ¥**: `http://localhost`
5. **"ì €ì¥" ë²„íŠ¼ í´ë¦­**

### ğŸ”‘ **5ë‹¨ê³„: ì•¡ì„¸ìŠ¤ í† í° ë°œê¸‰ (ìµœì‹  ë°©ë²•)**

#### **ë°©ë²• 1: ì•± í‚¤ í™•ì¸**
1. **ì™¼ìª½ ë©”ë‰´ì—ì„œ "ì•± í‚¤" í´ë¦­**
2. **"REST API í‚¤" ë³µì‚¬** (ì•± í‚¤ ì¤‘ í•˜ë‚˜)

#### **ë°©ë²• 2: ì‹¤ì œ ì•¡ì„¸ìŠ¤ í† í° ë°›ê¸°**
**REST API í‚¤ë§Œìœ¼ë¡œëŠ” ë¶€ì¡±í•˜ë¯€ë¡œ ì¶”ê°€ ê³¼ì •ì´ í•„ìš”í•©ë‹ˆë‹¤:**

1. **ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— ë‹¤ìŒ URL ì…ë ¥** (REST API í‚¤ë¥¼ ì‹¤ì œ í‚¤ë¡œ êµì²´):
```
https://kauth.kakao.com/oauth/authorize?client_id=ë‹¹ì‹ ì˜_REST_API_í‚¤&redirect_uri=http://localhost&response_type=code
```

ì˜ˆì‹œ:
```
https://kauth.kakao.com/oauth/authorize?client_id=abc123def456&redirect_uri=http://localhost&response_type=code
```

2. **ì¹´ì¹´ì˜¤ê³„ì • ë¡œê·¸ì¸**
3. **ë™ì˜í•­ëª© ì²´í¬ í›„ "ë™ì˜í•˜ê³  ê³„ì†í•˜ê¸°"**
4. **ì£¼ì†Œì°½ì—ì„œ code ê°’ ë³µì‚¬**:
   - ì£¼ì†Œê°€ ì´ë ‡ê²Œ ë³€í•¨: `http://localhost/?code=abc123xyz789`
   - **code=** ë’¤ì˜ ê°’ì„ ë³µì‚¬: `abc123xyz789`

5. **í† í° ë°œê¸‰ API í˜¸ì¶œ** (ì•„ë˜ ë°©ë²• ì¤‘ ì„ íƒ):

#### **ë°©ë²• 2-1: ì˜¨ë¼ì¸ ë„êµ¬ ì‚¬ìš©**
1. **https://httpbin.org/post ì ‘ì†**
2. **ë˜ëŠ” Postman ê°™ì€ ë„êµ¬ ì‚¬ìš©**

#### **ë°©ë²• 2-2: ê°„ë‹¨í•œ ë°©ë²• (ì¶”ì²œ)**
**ì‹¤ì œë¡œëŠ” ë§¤ìš° ë³µì¡í•˜ë¯€ë¡œ, ìš°ì„  í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ì§„í–‰í•˜ì„¸ìš”!**

### ğŸš¨ **ì‹¤ìš©ì ì¸ í•´ê²°ì±…:**

**ì¹´ì¹´ì˜¤ í† í° ë°œê¸‰ì´ ë³µì¡í•˜ë¯€ë¡œ**, ë‹¤ìŒ ìˆœì„œë¡œ ì§„í–‰í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•©ë‹ˆë‹¤:

#### **1ë‹¨ê³„: í…ŒìŠ¤íŠ¸ìš©ìœ¼ë¡œ ì‹œìŠ¤í…œ ì™„ì„±**
```json
{
  "message": "{{3.mission_message}}",
  "chat_id": "test_chat",
  "access_token": "test_token_for_demo"
}
```

#### **2ë‹¨ê³„: ì´ë¯¸ ìˆëŠ” í† í° ì‚¬ìš©** 
í˜¹ì‹œ ì´ì „ì— ì–¸ê¸‰í•˜ì‹  í† í°ì´ ìˆìœ¼ì‹œë©´:
```
nEwcLjt0zka2JYj94tYyDRHNVE_m...
```
ì´ê²ƒì„ ì‚¬ìš©í•´ë³´ì„¸ìš”!

#### **3ë‹¨ê³„: ì „ë¬¸ ë„êµ¬ ì‚¬ìš©**
ì‹¤ì œ ì¹´ì¹´ì˜¤í†¡ ì „ì†¡ì´ í•„ìš”í•˜ì‹œë©´:
- **ì¹´ì¹´ì˜¤í†¡ ë¹„ì¦ˆë‹ˆìŠ¤ ì±„ë„** ì‚¬ìš©
- **í…”ë ˆê·¸ë¨ ë´‡** ëŒ€ì•ˆ ê³ ë ¤
- **Slack/Discord** ì›¹í›… ì‚¬ìš© 

### âš¡ **4ë‹¨ê³„ ì„±ëŠ¥ ë¬¸ì œ í•´ê²°**

### ğŸŒ **ì™œ 4ë‹¨ê³„ê°€ ëŠë¦´ê¹Œìš”?**
1. **í° ì›¹ì‚¬ì´íŠ¸ ë¡œë”©**
2. **ë³µì¡í•œ JavaScript ì²˜ë¦¬**
3. **ë„¤íŠ¸ì›Œí¬ ì§€ì—°**

### ğŸš€ **ì¦‰ì‹œ í•´ê²° ë°©ë²•:**

#### **ë°©ë²• 1: Timeout ëŠ˜ë¦¬ê¸°**
1. **3ë‹¨ê³„ HTTP ëª¨ë“ˆ ë”ë¸”í´ë¦­**
2. **"Timeout" ì¹¸ì— `60` ì…ë ¥** (60ì´ˆ)
3. **"OK" í´ë¦­**

#### **ë°©ë²• 2: ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ URL ì‚¬ìš©**
**ì›ë³¸ URL ëŒ€ì‹  í…ŒìŠ¤íŠ¸ìš© ì‚¬ìš©:**
1. **URL ì¹¸ ë‚´ìš© ì‚­ì œ**
2. **ë‹¤ìŒ ì¤‘ í•˜ë‚˜ ì…ë ¥**:
```
https://httpbin.org/json
```
ë˜ëŠ”
```
https://jsonplaceholder.typicode.com/posts/1
```

#### **ë°©ë²• 3: 4ë‹¨ê³„ JavaScript ê°„ì†Œí™”**
**ë³µì¡í•œ íŒŒì‹± ëŒ€ì‹  ê°„ë‹¨í•œ ë©”ì‹œì§€:**

```javascript
// ê°„ë‹¨í•œ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€
const now = new Date();
const timeStr = now.toLocaleTimeString('ko-KR');

const testMessage = `ğŸš€ Gë¼ì´ë” í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€

ğŸ“… ${timeStr} ì—…ë°ì´íŠ¸

âœ… Make.com ìë™í™” ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™
ğŸ”„ ì‹¤ì œ ë°ì´í„° ì—°ë™ ì¤€ë¹„ ì™„ë£Œ

í…ŒìŠ¤íŠ¸ ì„±ê³µ! ğŸ‰`;

// ê²°ê³¼ ë°˜í™˜
testMessage;
```

### ğŸ¯ **ì¶”ì²œ ìˆœì„œ:**

1. **ğŸ” ë¨¼ì € ë³´ì•ˆ**: Private ì €ì¥ì†Œë¡œ ë³€ê²½
2. **âš¡ ì„±ëŠ¥ í•´ê²°**: í…ŒìŠ¤íŠ¸ URL + ê°„ë‹¨í•œ JavaScript
3. **âœ… ì‹œìŠ¤í…œ ì™„ì„±**: ê¸°ë³¸ ìë™í™” ì‘ë™ í™•ì¸
4. **ğŸ”§ ì‹¤ì œ ì—°ë™**: ë‚˜ì¤‘ì— ì‹¤ì œ URLê³¼ ë³µì¡í•œ ë¡œì§ ì¶”ê°€

ì§€ê¸ˆ ë‹¹ì¥ **ì–´ë–¤ ê²ƒë¶€í„° í•´ê²°**í•˜ê³  ì‹¶ìœ¼ì‹ ê°€ìš”? ğŸ¤” 