name: ğŸ” GitHub Secrets í…ŒìŠ¤íŠ¸

on:
  workflow_dispatch:
    inputs:
      test_type:
        description: 'í…ŒìŠ¤íŠ¸ ìœ í˜•'
        required: false
        default: 'all'
        type: choice
        options:
          - all
          - grider_only
          - kakao_only

jobs:
  test-secrets:
    name: ğŸ” Secrets ì„¤ì • í™•ì¸
    runs-on: ubuntu-latest
    timeout-minutes: 2
    
    steps:
    - name: ğŸ“¥ ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4

    - name: ğŸ” Gë¼ì´ë” ë¡œê·¸ì¸ ì •ë³´ í™•ì¸
      if: github.event.inputs.test_type == 'all' || github.event.inputs.test_type == 'grider_only'
      env:
        GRIDER_ID: ${{ secrets.GRIDER_ID }}
        GRIDER_PASSWORD: ${{ secrets.GRIDER_PASSWORD }}
      run: |
        echo "ğŸ” Gë¼ì´ë” ë¡œê·¸ì¸ ì •ë³´ í™•ì¸"
        echo "================================"
        
        if [ -n "$GRIDER_ID" ]; then
          echo "âœ… GRIDER_ID: ì„¤ì •ë¨ (ê¸¸ì´: ${#GRIDER_ID})"
          echo "   ì²« 3ê¸€ì: ${GRIDER_ID:0:3}***"
        else
          echo "âŒ GRIDER_ID: ì„¤ì •ë˜ì§€ ì•ŠìŒ"
        fi
        
        if [ -n "$GRIDER_PASSWORD" ]; then
          echo "âœ… GRIDER_PASSWORD: ì„¤ì •ë¨ (ê¸¸ì´: ${#GRIDER_PASSWORD})"
          echo "   ì²« 3ê¸€ì: ${GRIDER_PASSWORD:0:3}***"
        else
          echo "âŒ GRIDER_PASSWORD: ì„¤ì •ë˜ì§€ ì•ŠìŒ"
        fi
        
        echo ""
        echo "ğŸ’¡ ì„¤ì • ë°©ë²•:"
        echo "1. GitHub ì €ì¥ì†Œ â†’ Settings â†’ Secrets and variables â†’ Actions"
        echo "2. New repository secret í´ë¦­"
        echo "3. Name: GRIDER_ID, Value: ì‹¤ì œ_Gë¼ì´ë”_ì•„ì´ë””"
        echo "4. Name: GRIDER_PASSWORD, Value: ì‹¤ì œ_Gë¼ì´ë”_ë¹„ë°€ë²ˆí˜¸"

    - name: ğŸ” ì¹´ì¹´ì˜¤ API ì •ë³´ í™•ì¸
      if: github.event.inputs.test_type == 'all' || github.event.inputs.test_type == 'kakao_only'
      env:
        KAKAO_REST_API_KEY: ${{ secrets.KAKAO_REST_API_KEY }}
        KAKAO_REFRESH_TOKEN: ${{ secrets.KAKAO_REFRESH_TOKEN }}
      run: |
        echo "ğŸ” ì¹´ì¹´ì˜¤ API ì •ë³´ í™•ì¸"
        echo "================================"
        
        if [ -n "$KAKAO_REST_API_KEY" ]; then
          echo "âœ… KAKAO_REST_API_KEY: ì„¤ì •ë¨ (ê¸¸ì´: ${#KAKAO_REST_API_KEY})"
          echo "   ì²« 10ê¸€ì: ${KAKAO_REST_API_KEY:0:10}***"
        else
          echo "âŒ KAKAO_REST_API_KEY: ì„¤ì •ë˜ì§€ ì•ŠìŒ"
        fi
        
        if [ -n "$KAKAO_REFRESH_TOKEN" ]; then
          echo "âœ… KAKAO_REFRESH_TOKEN: ì„¤ì •ë¨ (ê¸¸ì´: ${#KAKAO_REFRESH_TOKEN})"
          echo "   ì²« 10ê¸€ì: ${KAKAO_REFRESH_TOKEN:0:10}***"
        else
          echo "âŒ KAKAO_REFRESH_TOKEN: ì„¤ì •ë˜ì§€ ì•ŠìŒ"
        fi
        
        echo ""
        echo "ğŸ’¡ ì„¤ì • ë°©ë²•:"
        echo "1. GitHub ì €ì¥ì†Œ â†’ Settings â†’ Secrets and variables â†’ Actions"
        echo "2. New repository secret í´ë¦­"
        echo "3. Name: KAKAO_REST_API_KEY, Value: ì‹¤ì œ_ì¹´ì¹´ì˜¤_REST_API_í‚¤"
        echo "4. Name: KAKAO_REFRESH_TOKEN, Value: ì‹¤ì œ_ì¹´ì¹´ì˜¤_ë¦¬í”„ë ˆì‹œ_í† í°"

    - name: ğŸ“‹ ì „ì²´ ì„¤ì • ìš”ì•½
      run: |
        echo "ğŸ“‹ ì „ì²´ ì„¤ì • ìš”ì•½"
        echo "================================"
        echo "ğŸ‡°ğŸ‡· í•œêµ­ì‹œê°„: $(TZ='Asia/Seoul' date '+%Y-%m-%d %H:%M:%S %Z')"
        echo ""
        echo "ğŸ”§ ë‹¤ìŒ ë‹¨ê³„:"
        echo "1. ìœ„ì—ì„œ âŒë¡œ í‘œì‹œëœ í•­ëª©ë“¤ì„ GitHub Secretsì— ì„¤ì •"
        echo "2. ì„¤ì • ì™„ë£Œ í›„ 'ğŸŒŸ ì°¨ì„¸ëŒ€ Gë¼ì´ë” ìë™í™” ì‹œìŠ¤í…œ' ì›Œí¬í”Œë¡œìš° ì‹¤í–‰"
        echo "3. ë˜ëŠ” Actions íƒ­ì—ì„œ 'Run workflow' í´ë¦­í•˜ì—¬ ìˆ˜ë™ ì‹¤í–‰" 