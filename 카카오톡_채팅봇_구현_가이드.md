# ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°© ì±„íŒ…ë´‡ êµ¬í˜„ ê°€ì´ë“œ

## ê°œìš”
ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°©ì—ì„œ ë¯¸ì…˜ í˜„í™© ë¦¬í¬íŠ¸ë¥¼ ìë™ìœ¼ë¡œ ì „ì†¡í•˜ëŠ” ì±„íŒ…ë´‡ì„ êµ¬í˜„í•˜ëŠ” 2ê°€ì§€ ë°©ë²•ì„ ì†Œê°œí•©ë‹ˆë‹¤.

---

## ë°©ë²• 1: ì¹´ì¹´ì˜¤ ì˜¤í”ˆë¹Œë” (KakaoTalk OpenBuilder) - ì¶”ì²œ â­

### 1.1 ê°œìš”
- ì¹´ì¹´ì˜¤ì—ì„œ ê³µì‹ ì œê³µí•˜ëŠ” ì±—ë´‡ í”Œë«í¼
- ì›¹í›…(Webhook) ë°©ì‹ìœ¼ë¡œ ì™¸ë¶€ ì„œë²„ì™€ ì—°ë™
- ì •ê¸° ë©”ì‹œì§€ ì „ì†¡ ë° ëª…ë ¹ì–´ ì‘ë‹µ ëª¨ë‘ ì§€ì›

### 1.2 êµ¬í˜„ ë‹¨ê³„

#### Step 1: ì¹´ì¹´ì˜¤ ì˜¤í”ˆë¹Œë” ì„¤ì •
1. **ì¹´ì¹´ì˜¤ ì˜¤í”ˆë¹Œë” ì ‘ì†**
   - https://chatbot.kakao.com/ ì ‘ì†
   - ì¹´ì¹´ì˜¤ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸

2. **ì±—ë´‡ ìƒì„±**
   ```
   - "ì±—ë´‡ ë§Œë“¤ê¸°" í´ë¦­
   - ë´‡ ì´ë¦„: "ë¯¸ì…˜í˜„í™©ë´‡"
   - ì„¤ëª…: "ë¯¸ì…˜ í˜„í™© ë¦¬í¬íŠ¸ ìë™ ì „ì†¡"
   - í”„ë¡œí•„ ì´ë¯¸ì§€ ì„¤ì •
   ```

3. **ì‹œë‚˜ë¦¬ì˜¤ ì„¤ì •**
   ```
   ì‹œë‚˜ë¦¬ì˜¤ > ë¸”ë¡ ì¶”ê°€
   - ë¸”ë¡ëª…: "ë¯¸ì…˜í˜„í™©"
   - ì‚¬ìš©ì ë°œí™”: "ë¯¸ì…˜", "í˜„í™©", "ë¦¬í¬íŠ¸", "ìƒíƒœ"
   - ì‘ë‹µ: ìŠ¤í‚¬ ì„œë²„ í˜¸ì¶œ
   ```

#### Step 2: ì›¹í›… ì„œë²„ êµ¬í˜„
```python
# kakao_webhook_server.py
from flask import Flask, request, jsonify
import json
from main_(2) import job, parse_data, crawl_jangboo, make_message

app = Flask(__name__)

@app.route('/webhook', methods=['POST'])
def webhook():
    """ì¹´ì¹´ì˜¤ ì˜¤í”ˆë¹Œë” ì›¹í›… ì—”ë“œí¬ì¸íŠ¸"""
    try:
        # ì¹´ì¹´ì˜¤ì—ì„œ ì „ì†¡ëœ ë°ì´í„° íŒŒì‹±
        data = request.get_json()
        user_utterance = data.get('userRequest', {}).get('utterance', '')
        
        # ë¯¸ì…˜ í˜„í™© ë°ì´í„° ìˆ˜ì§‘
        html = crawl_jangboo()
        mission_data = parse_data(html)
        message = make_message(mission_data)
        
        # ì¹´ì¹´ì˜¤ ì‘ë‹µ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        response = {
            "version": "2.0",
            "template": {
                "outputs": [
                    {
                        "simpleText": {
                            "text": message
                        }
                    }
                ],
                "quickReplies": [
                    {
                        "label": "ğŸ”„ ìƒˆë¡œê³ ì¹¨",
                        "action": "message",
                        "messageText": "ë¯¸ì…˜í˜„í™©"
                    },
                    {
                        "label": "ğŸ“Š ê·¸ë˜í”„",
                        "action": "message", 
                        "messageText": "ê·¸ë˜í”„"
                    }
                ]
            }
        }
        
        return jsonify(response)
        
    except Exception as e:
        error_response = {
            "version": "2.0",
            "template": {
                "outputs": [
                    {
                        "simpleText": {
                            "text": f"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}"
                        }
                    }
                ]
            }
        }
        return jsonify(error_response)

@app.route('/health', methods=['GET'])
def health():
    """ì„œë²„ ìƒíƒœ í™•ì¸"""
    return jsonify({"status": "healthy"})

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=5000, debug=True)
```

#### Step 3: ì •ê¸° ë©”ì‹œì§€ ì „ì†¡ êµ¬í˜„
```python
# scheduled_message_sender.py
import schedule
import time
import requests
import json
from main_(2) import job, parse_data, crawl_jangboo, make_message

# ì¹´ì¹´ì˜¤ ì˜¤í”ˆë¹Œë” API ì„¤ì •
KAKAO_API_URL = "https://kapi.kakao.com/v2/api/talk/memo/default/send"
KAKAO_ACCESS_TOKEN = "YOUR_ACCESS_TOKEN"  # ì¹´ì¹´ì˜¤ ê°œë°œì ì½˜ì†”ì—ì„œ ë°œê¸‰

def send_scheduled_message():
    """ì •ê¸° ë©”ì‹œì§€ ì „ì†¡"""
    try:
        # ë¯¸ì…˜ í˜„í™© ë°ì´í„° ìˆ˜ì§‘
        html = crawl_jangboo()
        mission_data = parse_data(html)
        message = make_message(mission_data)
        
        # ì¹´ì¹´ì˜¤í†¡ ë©”ì‹œì§€ ì „ì†¡
        headers = {
            "Authorization": f"Bearer {KAKAO_ACCESS_TOKEN}",
            "Content-Type": "application/x-www-form-urlencoded"
        }
        
        data = {
            "template_object": json.dumps({
                "object_type": "text",
                "text": message,
                "link": {
                    "web_url": "https://your-dashboard.com",
                    "mobile_web_url": "https://your-dashboard.com"
                }
            })
        }
        
        response = requests.post(KAKAO_API_URL, headers=headers, data=data)
        
        if response.status_code == 200:
            print(f"âœ… ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ: {time.strftime('%Y-%m-%d %H:%M:%S')}")
        else:
            print(f"âŒ ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨: {response.text}")
            
    except Exception as e:
        print(f"âŒ ì˜¤ë¥˜ ë°œìƒ: {str(e)}")

# ìŠ¤ì¼€ì¤„ ì„¤ì •
def setup_schedule():
    """ë©”ì‹œì§€ ì „ì†¡ ìŠ¤ì¼€ì¤„ ì„¤ì •"""
    # ë§¤ì¼ íŠ¹ì • ì‹œê°„ì— ì „ì†¡
    schedule.every().day.at("10:00").do(send_scheduled_message)
    schedule.every().day.at("14:00").do(send_scheduled_message)
    schedule.every().day.at("18:00").do(send_scheduled_message)
    schedule.every().day.at("22:00").do(send_scheduled_message)
    
    # 30ë¶„ë§ˆë‹¤ ì „ì†¡ (ì—…ë¬´ì‹œê°„)
    for hour in range(10, 23):
        schedule.every().day.at(f"{hour:02d}:00").do(send_scheduled_message)
        schedule.every().day.at(f"{hour:02d}:30").do(send_scheduled_message)

if __name__ == "__main__":
    setup_schedule()
    print("ğŸ“… ì •ê¸° ë©”ì‹œì§€ ì „ì†¡ ì„œë¹„ìŠ¤ ì‹œì‘!")
    
    while True:
        schedule.run_pending()
        time.sleep(1)
```

#### Step 4: ì˜¤í”ˆì±„íŒ…ë°© ì—°ë™
1. **ì±—ë´‡ì„ ì˜¤í”ˆì±„íŒ…ë°©ì— ì´ˆëŒ€**
   ```
   - ì˜¤í”ˆë¹Œë”ì—ì„œ "ë°°í¬" íƒ­ ì´ë™
   - "ì˜¤í”ˆì±„íŒ…" ì„ íƒ
   - ì±„íŒ…ë°© URL ì…ë ¥ ë˜ëŠ” QRì½”ë“œ ìŠ¤ìº”
   - ë´‡ì„ ì±„íŒ…ë°©ì— ì¶”ê°€
   ```

2. **ê¶Œí•œ ì„¤ì •**
   ```
   - ì±„íŒ…ë°© ê´€ë¦¬ì ê¶Œí•œ í•„ìš”
   - ë´‡ ë©”ì‹œì§€ ì „ì†¡ ê¶Œí•œ í™œì„±í™”
   - ìë™ ì‘ë‹µ ì„¤ì •
   ```

---

## ë°©ë²• 2: ì¹´ì¹´ì˜¤í†¡ ì±„ë„ (êµ¬ í”ŒëŸ¬ìŠ¤ì¹œêµ¬) + ë©”ì‹œì§€ API

### 2.1 ê°œìš”
- ì¹´ì¹´ì˜¤í†¡ ë¹„ì¦ˆë‹ˆìŠ¤ ì±„ë„ì„ í†µí•œ ë©”ì‹œì§€ ì „ì†¡
- ì•Œë¦¼í†¡, ì¹œêµ¬í†¡ í˜•íƒœë¡œ ë©”ì‹œì§€ ë°œì†¡
- ëŒ€ëŸ‰ ë°œì†¡ ë° ê°œì¸í™” ë©”ì‹œì§€ ì§€ì›

### 2.2 êµ¬í˜„ ë‹¨ê³„

#### Step 1: ì¹´ì¹´ì˜¤í†¡ ì±„ë„ ìƒì„±
1. **ì¹´ì¹´ì˜¤í†¡ ì±„ë„ ê´€ë¦¬ìì„¼í„° ì ‘ì†**
   - https://center-pf.kakao.com/ ì ‘ì†
   - ì¹´ì¹´ì˜¤ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸

2. **ì±„ë„ ìƒì„±**
   ```
   - "ìƒˆ ì±„ë„ ë§Œë“¤ê¸°" í´ë¦­
   - ì±„ë„ëª…: "ë¯¸ì…˜í˜„í™©ì•Œë¦¼"
   - ì¹´í…Œê³ ë¦¬: "ê¸°íƒ€"
   - ì±„ë„ ì†Œê°œ ì‘ì„±
   ```

#### Step 2: ë©”ì‹œì§€ API ì„¤ì •
```python
# kakao_channel_sender.py
import requests
import json
from datetime import datetime
from main_(2) import parse_data, crawl_jangboo, make_message

class KakaoChannelSender:
    def __init__(self, rest_api_key, channel_uuid):
        self.rest_api_key = rest_api_key
        self.channel_uuid = channel_uuid
        self.base_url = "https://kapi.kakao.com"
    
    def send_message_to_friends(self, message):
        """ì¹œêµ¬ë“¤ì—ê²Œ ë©”ì‹œì§€ ì „ì†¡"""
        url = f"{self.base_url}/v1/api/talk/friends/message/default/send"
        
        headers = {
            "Authorization": f"Bearer {self.rest_api_key}",
            "Content-Type": "application/x-www-form-urlencoded"
        }
        
        template_object = {
            "object_type": "text",
            "text": message,
            "link": {
                "web_url": "https://your-dashboard.com"
            },
            "button_title": "ìì„¸íˆ ë³´ê¸°"
        }
        
        data = {
            "template_object": json.dumps(template_object)
        }
        
        response = requests.post(url, headers=headers, data=data)
        return response.status_code == 200
    
    def send_custom_message(self, receiver_uuids, message):
        """íŠ¹ì • ì‚¬ìš©ìë“¤ì—ê²Œ ê°œì¸í™” ë©”ì‹œì§€ ì „ì†¡"""
        url = f"{self.base_url}/v1/api/talk/friends/message/default/send"
        
        headers = {
            "Authorization": f"Bearer {self.rest_api_key}",
            "Content-Type": "application/x-www-form-urlencoded"
        }
        
        data = {
            "receiver_uuids": json.dumps(receiver_uuids),
            "template_object": json.dumps({
                "object_type": "text",
                "text": message
            })
        }
        
        response = requests.post(url, headers=headers, data=data)
        return response.status_code == 200

# ì‚¬ìš© ì˜ˆì‹œ
sender = KakaoChannelSender(
    rest_api_key="YOUR_REST_API_KEY",
    channel_uuid="YOUR_CHANNEL_UUID"
)

def send_mission_report():
    """ë¯¸ì…˜ ë¦¬í¬íŠ¸ ì „ì†¡"""
    html = crawl_jangboo()
    data = parse_data(html)
    message = make_message(data)
    
    success = sender.send_message_to_friends(message)
    if success:
        print("âœ… ë©”ì‹œì§€ ì „ì†¡ ì„±ê³µ")
    else:
        print("âŒ ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨")
```

---

## ë°©ë²• 3: ì„œë“œíŒŒí‹° ì†”ë£¨ì…˜ (KakaoTalk-Bot)

### 3.1 ê°œìš”
- ë¹„ê³µì‹ ì¹´ì¹´ì˜¤í†¡ ë´‡ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©
- ê°œì¸ ì¹´ì¹´ì˜¤í†¡ ê³„ì •ì„ ë´‡ìœ¼ë¡œ í™œìš©
- ì£¼ì˜: ì¹´ì¹´ì˜¤ ì •ì±… ìœ„ë°˜ ê°€ëŠ¥ì„± ìˆìŒ

### 3.2 êµ¬í˜„ ì˜ˆì‹œ
```python
# unofficial_kakao_bot.py
from selenium import webdriver
from selenium.webdriver.common.by import By
import time
import schedule

class KakaoTalkBot:
    def __init__(self):
        self.driver = None
        self.setup_driver()
    
    def setup_driver(self):
        """ì›¹ë“œë¼ì´ë²„ ì„¤ì •"""
        options = webdriver.ChromeOptions()
        options.add_argument('--user-data-dir=./kakao_profile')
        self.driver = webdriver.Chrome(options=options)
    
    def login_kakao_web(self):
        """ì¹´ì¹´ì˜¤í†¡ ì›¹ ë¡œê·¸ì¸"""
        self.driver.get('https://web.kakao.com/')
        # QRì½”ë“œ ìŠ¤ìº” ëŒ€ê¸°
        input("QRì½”ë“œë¥¼ ìŠ¤ìº”í•œ í›„ Enterë¥¼ ëˆ„ë¥´ì„¸ìš”...")
    
    def send_message_to_chat(self, chat_name, message):
        """íŠ¹ì • ì±„íŒ…ë°©ì— ë©”ì‹œì§€ ì „ì†¡"""
        try:
            # ì±„íŒ…ë°© ê²€ìƒ‰
            search_box = self.driver.find_element(By.CSS_SELECTOR, 'input[placeholder="ëŒ€í™”ë°©ì„ ê²€ìƒ‰í•´ë³´ì„¸ìš”."]')
            search_box.clear()
            search_box.send_keys(chat_name)
            time.sleep(2)
            
            # ì±„íŒ…ë°© í´ë¦­
            chat_room = self.driver.find_element(By.XPATH, f'//span[contains(text(), "{chat_name}")]')
            chat_room.click()
            time.sleep(1)
            
            # ë©”ì‹œì§€ ì…ë ¥ ë° ì „ì†¡
            message_box = self.driver.find_element(By.CSS_SELECTOR, 'div[contenteditable="true"]')
            message_box.clear()
            message_box.send_keys(message)
            
            send_button = self.driver.find_element(By.CSS_SELECTOR, 'button[type="submit"]')
            send_button.click()
            
            return True
        except Exception as e:
            print(f"ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨: {e}")
            return False

# ì‚¬ìš© ì˜ˆì‹œ
bot = KakaoTalkBot()
bot.login_kakao_web()

def send_scheduled_report():
    """ì •ê¸° ë¦¬í¬íŠ¸ ì „ì†¡"""
    from main_(2) import crawl_jangboo, parse_data, make_message
    
    html = crawl_jangboo()
    data = parse_data(html)
    message = make_message(data)
    
    # ì—¬ëŸ¬ ì±„íŒ…ë°©ì— ì „ì†¡
    chat_rooms = ["ë¯¸ì…˜í˜„í™©ë°©", "ë¼ì´ë”ê·¸ë£¹", "ê´€ë¦¬ìë°©"]
    
    for room in chat_rooms:
        success = bot.send_message_to_chat(room, message)
        if success:
            print(f"âœ… {room}ì— ë©”ì‹œì§€ ì „ì†¡ ì™„ë£Œ")
        time.sleep(2)  # ìŠ¤íŒ¸ ë°©ì§€

# ìŠ¤ì¼€ì¤„ ì„¤ì •
schedule.every().day.at("10:00").do(send_scheduled_report)
schedule.every().day.at("14:00").do(send_scheduled_report)
schedule.every().day.at("18:00").do(send_scheduled_report)
schedule.every().day.at("22:00").do(send_scheduled_report)
```

---

## ì¶”ì²œ êµ¬í˜„ ë°©ë²•

### ğŸ¥‡ 1ìˆœìœ„: ì¹´ì¹´ì˜¤ ì˜¤í”ˆë¹Œë” (ê³µì‹)
**ì¥ì :**
- ì¹´ì¹´ì˜¤ ê³µì‹ ì§€ì›
- ì•ˆì •ì ì´ê³  ì‹ ë¢°ì„± ë†’ìŒ
- ë‹¤ì–‘í•œ ê¸°ëŠ¥ ì§€ì› (ë²„íŠ¼, ì¹´ë“œ, ì´ë¯¸ì§€ ë“±)
- ë¬´ë£Œ ì‚¬ìš© ê°€ëŠ¥

**ë‹¨ì :**
- ì´ˆê¸° ì„¤ì •ì´ ë³µì¡
- ì›¹í›… ì„œë²„ í•„ìš”

### ğŸ¥ˆ 2ìˆœìœ„: ì¹´ì¹´ì˜¤í†¡ ì±„ë„ + ë©”ì‹œì§€ API
**ì¥ì :**
- ëŒ€ëŸ‰ ë°œì†¡ ê°€ëŠ¥
- ê°œì¸í™” ë©”ì‹œì§€ ì§€ì›
- í†µê³„ ë° ë¶„ì„ ê¸°ëŠ¥

**ë‹¨ì :**
- ìœ ë£Œ ì„œë¹„ìŠ¤
- ì±„ë„ ì¹œêµ¬ ì¶”ê°€ í•„ìš”

### ğŸ¥‰ 3ìˆœìœ„: ì„œë“œíŒŒí‹° ì†”ë£¨ì…˜
**ì¥ì :**
- êµ¬í˜„ì´ ê°„ë‹¨
- ê¸°ì¡´ ê°œì¸ ê³„ì • í™œìš©

**ë‹¨ì :**
- ì •ì±… ìœ„ë°˜ ìœ„í—˜
- ë¶ˆì•ˆì •í•¨
- ê³„ì • ì •ì§€ ê°€ëŠ¥ì„±

---

## ì‹¤ì œ ë°°í¬ ê°€ì´ë“œ

### ì„œë²„ ë°°í¬ (AWS/GCP/Heroku)
```bash
# requirements.txt
flask==2.3.3
requests==2.31.0
schedule==1.2.0
selenium==4.15.0
beautifulsoup4==4.12.2
python-dotenv==1.0.0

# Dockerfile
FROM python:3.9-slim
WORKDIR /app
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY . .
EXPOSE 5000
CMD ["python", "kakao_webhook_server.py"]
```

### í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
```bash
# .env
KAKAO_REST_API_KEY=your_rest_api_key
KAKAO_CHANNEL_UUID=your_channel_uuid
WEBHOOK_URL=https://your-server.com/webhook
USER_ID=your_login_id
USER_PW=your_login_password
```

---

## ë§ˆë¬´ë¦¬

ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°©ì—ì„œ ë¯¸ì…˜ í˜„í™© ë´‡ì„ êµ¬í˜„í•˜ëŠ” ê°€ì¥ ì•ˆì „í•˜ê³  íš¨ê³¼ì ì¸ ë°©ë²•ì€ **ì¹´ì¹´ì˜¤ ì˜¤í”ˆë¹Œë”**ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. 

ê³µì‹ ì§€ì›ë˜ëŠ” ë°©ë²•ì´ë¯€ë¡œ ì•ˆì •ì„±ì´ ë†’ê³ , ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ í™œìš©í•  ìˆ˜ ìˆì–´ ì¥ê¸°ì ìœ¼ë¡œ ê°€ì¥ ì¢‹ì€ ì„ íƒì…ë‹ˆë‹¤.

êµ¬í˜„ ê³¼ì •ì—ì„œ ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ë¬¸ì˜í•´ ì£¼ì„¸ìš”! ğŸš€ 