# 🤖 카카오 i 오픈빌더 완전 자동화 설정 가이드

## 📋 **목차**
1. [카카오 i 오픈빌더 챗봇 생성](#1-카카오-i-오픈빌더-챗봇-생성)
2. [웹훅 설정](#2-웹훅-설정)
3. [오픈채팅방에 챗봇 추가](#3-오픈채팅방에-챗봇-추가)
4. [GitHub Secrets 설정](#4-github-secrets-설정)
5. [테스트 및 배포](#5-테스트-및-배포)

---

## 1. 카카오 i 오픈빌더 챗봇 생성

### 1.1 오픈빌더 접속
- 🌐 **https://i.kakao.com** 접속
- 카카오 계정으로 로그인

### 1.2 새 봇 생성
1. **"봇 만들기"** 클릭
2. **봇 이름**: `G라이더 자동 리포터`
3. **봇 설명**: `G라이더 미션 현황을 자동으로 전송하는 봇`
4. **봇 아이콘**: 적절한 이미지 업로드

### 1.3 기본 시나리오 설정
1. **"시나리오"** 메뉴 → **"폴백 블록"** 선택
2. **"웹훅 스킬"** 추가
3. **웹훅 URL**: `https://your-server.com/webhook` (나중에 설정)

---

## 2. 웹훅 설정

### 2.1 웹훅 스킬 생성
1. **"스킬"** 메뉴 → **"웹훅 스킬"** 
2. **스킬 이름**: `grider_report_webhook`
3. **URL**: 임시로 설정 (GitHub Actions에서 사용할 URL)

### 2.2 웹훅 응답 형식 설정
```json
{
  "version": "2.0",
  "template": {
    "outputs": [
      {
        "simpleText": {
          "text": "{{message}}"
        }
      }
    ]
  }
}
```

---

## 3. 오픈채팅방에 챗봇 추가

### 3.1 봇 ID 확인
1. **"기본정보"** 메뉴에서 **봇 ID** 복사
2. 형식: `@grider_reporter_bot` (예시)

### 3.2 오픈채팅방에 봇 초대
1. **카카오톡** → **오픈채팅방** (`gt26QiBg`) 입장
2. **우측 상단 ☰** → **"채팅방 설정"**
3. **"참여자 관리"** → **"참여자 초대"**
4. **검색창에 봇 ID 입력** (`@grider_reporter_bot`)
5. **챗봇 선택** → **"초대"**

### 3.3 봇 권한 설정
- 챗봇이 **"봇 참여자"**로 추가되는지 확인
- 메시지 전송 권한 확인

---

## 4. GitHub Secrets 설정

### 4.1 필요한 환경변수
GitHub 저장소 → **Settings** → **Secrets and variables** → **Actions**

#### 추가할 Secret:
```
KAKAO_OPENBUILDER_WEBHOOK: https://i.kakao.com/webhook/your-bot-id
KAKAO_ACCESS_TOKEN: (기존 백업용)
KAKAO_REST_API_KEY: (기존 백업용)
```

### 4.2 웹훅 URL 생성
1. **오픈빌더** → **"배포"** 메뉴
2. **"채널 연결"** → **"카카오톡 채널"**
3. **웹훅 URL** 복사하여 GitHub Secrets에 추가

---

## 5. 테스트 및 배포

### 5.1 로컬 테스트
```bash
# 환경변수 설정
export KAKAO_OPENBUILDER_WEBHOOK="https://i.kakao.com/webhook/your-bot-id"

# 스크립트 실행
python github_actions_sender.py
```

### 5.2 GitHub Actions 수동 실행
1. **GitHub** → **Actions** 탭
2. **"G라이더 완전 자동화 시스템"** 선택
3. **"Run workflow"** → **"manual"** 선택
4. **실행 결과 확인**

### 5.3 자동 스케줄 확인
- **10:00**: 첫 메시지 (하루 시작 인사)
- **10:30~23:30**: 30분 간격 기본 전송
- **피크시간**: 15분 간격 추가 전송
  - 평일: 06:00~13:00, 17:00~20:00
  - 휴일: 06:00~14:00, 17:00~20:00
- **00:00**: 자정 마무리 메시지

---

## 🎯 **완전 자동화 시스템 특징**

### ✅ **무인 운영**
- 사용자 개입 **0%**
- QR 코드 스캔 불필요
- 세션 만료 걱정 없음

### ✅ **스마트 스케줄링**
- 평일/휴일 자동 구분
- **한국 공휴일** 자동 인식
- 피크/논피크 시간 자동 조정

### ✅ **센스 있는 메시지**
- 시간대별 맞춤 인사
- 자정 **"고생하셨다"** 메시지
- 날씨 정보 포함

---

## 🚨 **주의사항**

1. **봇 승인**: 카카오 i 오픈빌더 OBT 신청 필요
2. **채팅방 권한**: 오픈채팅방 관리자 권한 필요
3. **웹훅 URL**: 올바른 웹훅 URL 설정 확인
4. **테스트**: 실제 배포 전 반드시 테스트

---

## 💡 **문제 해결**

### Q. 봇이 메시지를 보내지 않아요
A. 웹훅 URL과 GitHub Secrets 설정을 확인하세요

### Q. 오픈채팅방에 봇을 찾을 수 없어요  
A. 봇 ID가 정확한지, 봇이 공개 설정되어 있는지 확인하세요

### Q. 공휴일 인식이 안돼요
A. `holidays` 패키지가 설치되어 있는지 확인하세요

---

## 🎉 **완성!**

이제 **완전 무인 자동화 시스템**이 완성되었습니다!
매일 정해진 시간에 자동으로 G라이더 리포트가 전송됩니다! 🚀 