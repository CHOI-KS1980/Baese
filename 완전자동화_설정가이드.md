# 🍕 배민 G라이더 완전 자동화 시스템 설정 가이드

## 🎯 시스템 개요

GitHub Actions + 카카오 i 오픈빌더를 활용한 **완전 무인 자동화** 시스템으로, G라이더 미션 현황을 카카오톡 오픈채팅방에 자동 전송합니다.

### ⚡ 자동화 특징
- **24시간 무인 운영**: GitHub Actions 스케줄러 기반
- **스마트 스케줄링**: 평일/휴일별, 피크/논피크 시간 차별화
- **한국 공휴일 지원**: 한국천문연구원 API 실시간 연동
- **이중화 시스템**: 메인/백업 웹훅으로 안정성 보장
- **실시간 모니터링**: 성공/실패 로그 자동 기록

---

## 🚀 **1단계: GitHub Secrets 설정 (필수)**

### 1-1. GitHub 저장소 Settings 접속
1. **GitHub.com** → **baemin** 저장소 접속
2. **Settings** 탭 클릭
3. 좌측 메뉴 → **Secrets and variables** → **Actions** 클릭

### 1-2. 필수 Secrets 추가
**New repository secret** 버튼을 클릭하여 다음 7개 키를 하나씩 추가:

| Secret 이름 | 설명 | 발급 방법 | 필수 여부 |
|-------------|------|-----------|-----------|
| `KAKAO_ACCESS_TOKEN` | 카카오 오픈빌더 액세스 토큰 | 카카오 i 오픈빌더에서 발급 | ✅ 필수 |
| `KAKAO_OPENCHAT_ID` | 카카오톡 오픈채팅방 ID | 카카오톡에서 확인 | ✅ 필수 |
| `KAKAO_OPENBUILDER_WEBHOOK` | 오픈빌더 웹훅 URL | 카카오 i 오픈빌더에서 설정 | ✅ 필수 |
| `KOREA_HOLIDAY_API_KEY` | 한국천문연구원 공휴일 API 키 | 공공데이터포털에서 신청 | ✅ 필수 |
| `WEBHOOK_URL` | 메인 웹훅 URL | 카카오 오픈빌더 또는 외부 서비스 | ✅ 필수 |
| `FALLBACK_WEBHOOK_URL` | 백업 웹훅 URL | 백업용 웹훅 서비스 | ⚠️ 권장 |
| `WEATHER_API_KEY` | 날씨 API 키 | OpenWeatherMap 등에서 발급 | 🔵 선택 |

---

## 🤖 **2단계: 카카오 i 오픈빌더 설정**

### 2-1. 카카오 i 오픈빌더 계정 생성
1. [카카오 i 오픈빌더](https://i.kakao.com/) 접속
2. 카카오 계정으로 로그인
3. **새 챗봇 만들기** 클릭

### 2-2. 챗봇 기본 설정
```
챗봇 이름: 배민 G라이더 미션봇
설명: 배달의민족 G라이더 미션 현황 자동 알림 시스템
카테고리: 비즈니스/업무
```

### 2-3. 스킬 서버 설정
1. **시나리오** → **폴백 블록** 선택
2. **스킬** 탭 → **스킬 그룹 추가**
3. 스킬 설정:
   ```
   스킬명: G라이더 미션 알림
   URL: https://webhook.site/your-unique-url (임시)
   헤더: Content-Type: application/json
   ```

### 2-4. 토큰 및 웹훅 URL 복사
1. **설정** → **봇 설정** → **Token** 복사 → `KAKAO_ACCESS_TOKEN`
2. **스킬** 설정에서 웹훅 URL 복사 → `KAKAO_OPENBUILDER_WEBHOOK`

### 2-5. 카카오톡 채널 연결
1. **설정** → **채널** → 카카오톡 채널 생성
2. 오픈채팅방 생성 후 채팅방 ID 확인 → `KAKAO_OPENCHAT_ID`

---

## 🏛️ **3단계: 한국천문연구원 API 설정**

### 3-1. 공공데이터포털 가입
1. [공공데이터포털](https://data.go.kr/) 접속
2. 회원가입 및 로그인

### 3-2. 특일정보 API 신청
1. 검색: **"한국천문연구원 특일 정보"**
2. **활용신청** 클릭
3. 신청 사유:
   ```
   배달의민족 G라이더 미션 자동화 시스템에서 
   한국 공휴일 정보를 실시간으로 확인하여 
   평일/휴일별 차별화된 알림 서비스 제공
   ```

### 3-3. API 키 발급 (승인 후)
1. **마이페이지** → **개발계정** → **인증키** 복사
2. GitHub Secrets → `KOREA_HOLIDAY_API_KEY`에 입력

---

## 🌤️ **4단계: 날씨 API 설정 (선택사항)**

### 4-1. OpenWeatherMap 가입
1. [OpenWeatherMap](https://openweathermap.org/api) 접속
2. **Sign Up** → 무료 계정 생성

### 4-2. API 키 발급
1. **API Keys** 탭 → 기본 키 복사
2. GitHub Secrets → `WEATHER_API_KEY`에 입력

---

## 📅 **5단계: 자동 실행 스케줄 확인**

### 자동 실행 시간 (모든 시간은 한국시간 KST 기준)

#### 🌅 **기본 스케줄**
- **09:00**: 하루 시작 인사 메시지
- **09:30~23:30**: 30분 간격 정기 알림
- **00:00**: 하루 마무리 메시지

#### 🔥 **피크시간 강화 (15분 간격 추가)**
- **평일**: 06:00~13:00 (아침점심), 17:00~20:00 (저녁)
- **휴일**: 06:00~14:00 (아침점심), 17:00~20:00 (저녁)

#### 📊 **실행 빈도**
- **평일**: 하루 약 **45회** 실행
- **휴일**: 하루 약 **50회** 실행
- **공휴일**: 자동 인식하여 휴일 스케줄 적용

---

## ✅ **6단계: 테스트 및 실행**

### 6-1. 수동 테스트 실행
1. **GitHub** → **baemin 저장소** → **Actions** 탭
2. **🍕 배민 G라이더 미션 자동화** 워크플로우 선택
3. **Run workflow** → **message_type**: `test` 선택 → **Run workflow**

### 6-2. 실행 로그 확인
1. 실행 중인 워크플로우 클릭
2. **send-baemin-grider-mission** 단계별 로그 확인
3. 성공/실패 여부 및 오류 메시지 점검

### 6-3. 카카오톡 메시지 확인
- 설정이 올바르면 오픈채팅방에 테스트 메시지 전송됨
- 메시지 형식과 내용 확인

---

## 🔧 **7단계: 고급 설정 (선택사항)**

### 7-1. 메시지 커스터마이징
`github_actions_sender.py` 파일에서 메시지 포맷 수정 가능:
- 리포트 형식 변경
- 이모지 및 텍스트 스타일 조정
- 추가 정보 포함 (라이더 순위, 통계 등)

### 7-2. 스케줄 조정
`.github/workflows/baemin-grider-automation.yml`에서:
- cron 스케줄 수정
- 피크시간 조정
- 알림 빈도 변경

### 7-3. 알림 채널 추가
- Slack, Discord, 텔레그램 등 추가 채널 연동
- 이메일 알림 시스템 구축
- SMS 알림 서비스 연동

---

## 🛡️ **보안 및 모니터링**

### 보안 사항
- ✅ 모든 API 키는 GitHub Secrets로 안전 관리
- ✅ 토큰 노출 방지를 위한 환경변수 사용
- ✅ 로그에서 민감 정보 마스킹 처리

### 모니터링
- 📊 GitHub Actions 로그로 실행 상태 추적
- 📈 성공/실패 통계 자동 수집
- 🚨 실패 시 자동 알림 시스템

---

## 🚨 **문제 해결**

### 자주 발생하는 문제

**1. 메시지가 전송되지 않음**
```
원인: 카카오 API 토큰 또는 웹훅 URL 오류
해결: GitHub Secrets 설정 재확인
```

**2. 공휴일 인식 오류**
```
원인: 한국천문연구원 API 키 문제
해결: 공공데이터포털에서 API 승인 상태 확인
```

**3. 스케줄이 실행되지 않음**
```
원인: cron 표현식 오류 또는 GitHub Actions 비활성화
해결: 워크플로우 파일 문법 검사 및 Actions 설정 확인
```

### 로그 확인 방법
1. **GitHub** → **Actions** → 실행된 워크플로우
2. 실패한 단계 클릭하여 상세 로그 확인
3. 오류 메시지를 바탕으로 해당 설정 수정

---

## 🎉 **완료 후 기대 효과**

### ⚡ 업무 효율성
- **수동 작업 100% 제거**: 미션 현황 확인 자동화
- **실시간 모니터링**: 24시간 무중단 알림 서비스
- **정확한 정보 제공**: API 기반 실시간 데이터

### 📈 운영 최적화
- **스마트 스케줄링**: 피크/논피크 시간 차별화
- **한국 특화**: 공휴일 자동 인식 및 대응
- **확장성**: 추가 기능 및 채널 연동 용이

### 💰 비용 절감
- **GitHub Actions**: 월 2,000분 무료 (충분함)
- **카카오 i 오픈빌더**: 기본 기능 무료
- **공공 API**: 무료 제공

---

## 📞 **지원 및 문의**

설정 중 문제 발생 시:
1. **GitHub Issues**에 문제 상황 공유
2. 워크플로우 로그 스크린샷 첨부
3. 설정한 Secrets 목록 확인 (값은 공유 금지!)

---

**🍕 설정 완료 후 완전 자동화된 배민 G라이더 미션 관리를 즐기세요!** 