name: ì¹´ì¹´ì˜¤í†¡ ì˜¤í”ˆì±„íŒ…ë°© ìë™ ë¯¸ì…˜ ì „ì†¡

on:
  schedule:
    # ì›”-ê¸ˆ 09:00 KST (00:00 UTC) - ì•„ì¹¨ ì¸ì‚¬
    - cron: '0 0 * * 1-5'
    
    # ì›”-ê¸ˆ 09:30-23:30 KST - 30ë¶„ ê°„ê²© (í”¼í¬íƒ€ì„ ì œì™¸)
    - cron: '30 0,1,2,3,4,5,7,8,9,10,11,14,15,16,17,18,19,20,21,22,23 * * 1-5'
    
    # ì›”-ê¸ˆ 06:00-13:00, 17:00-20:00 KST - í”¼í¬íƒ€ì„ 15ë¶„ ê°„ê²©
    - cron: '0,15,30,45 21,22,23,0,1,2,3,4,8,9,10,11 * * 1-5'
    
    # í† ì¼ê³µíœ´ì¼ 09:00 KST (00:00 UTC) - ì•„ì¹¨ ì¸ì‚¬
    - cron: '0 0 * * 0,6'
    
    # í† ì¼ê³µíœ´ì¼ 09:30-23:30 KST - 30ë¶„ ê°„ê²© (í”¼í¬íƒ€ì„ ì œì™¸)
    - cron: '30 0,1,2,3,4,5,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23 * * 0,6'
    
    # í† ì¼ê³µíœ´ì¼ 06:00-14:00, 17:00-20:00 KST - í”¼í¬íƒ€ì„ 15ë¶„ ê°„ê²©
    - cron: '0,15,30,45 21,22,23,0,1,2,3,4,5,8,9,10,11 * * 0,6'
    
    # ë§¤ì¼ ìì • 00:00 KST (15:00 UTC ì´ì „ë‚ ) - ë§ˆë¬´ë¦¬ ì¸ì‚¬
    - cron: '0 15 * * *'
    
  workflow_dispatch:

env:
  PYTHON_VERSION: '3.9'

jobs:
  send-mission:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
    - name: ğŸ›’ ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4
      
    - name: ğŸ Python ì„¤ì •
      uses: actions/setup-python@v4
      with:
        python-version: ${{ env.PYTHON_VERSION }}
        cache: 'pip'
        
    - name: ğŸ“¦ ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
        
    - name: ğŸ• í˜„ì¬ ì‹œê°„ í™•ì¸ (í•œêµ­ì‹œê°„)
      run: |
        echo "GitHub Actions ì‹¤í–‰ ì‹œê°„ (UTC): $(date -u)"
        echo "í•œêµ­ ì‹œê°„ (KST): $(TZ='Asia/Seoul' date)"
        
    - name: ğŸš€ ì¹´ì¹´ì˜¤í†¡ ë©”ì‹œì§€ ì „ì†¡
      env:
        KAKAO_REST_API_KEY: ${{ secrets.KAKAO_REST_API_KEY }}
        KAKAO_CHANNEL_ID: ${{ secrets.KAKAO_CHANNEL_ID }}
        KOREA_HOLIDAY_API_KEY: ${{ secrets.KOREA_HOLIDAY_API_KEY }}
        OPENWEATHER_API_KEY: ${{ secrets.OPENWEATHER_API_KEY }}
        WEBHOOK_URL: ${{ secrets.WEBHOOK_URL }}
        DEBUG_MODE: 'false'
      run: |
        echo "ğŸ¯ ì¹´ì¹´ì˜¤í†¡ ìë™ ì „ì†¡ ì‹œì‘..."
        python github_actions_sender.py
        echo "âœ… ì¹´ì¹´ì˜¤í†¡ ìë™ ì „ì†¡ ì™„ë£Œ!"
        
    - name: ğŸ“Š ì‹¤í–‰ ê²°ê³¼ ë¡œê¹…
      if: always()
      run: |
        echo "=== ì‹¤í–‰ ê²°ê³¼ ==="
        echo "ì›Œí¬í”Œë¡œìš° ìƒíƒœ: ${{ job.status }}"
        echo "í•œêµ­ ì‹œê°„: $(TZ='Asia/Seoul' date)"
        echo "ì‹¤í–‰ ì™„ë£Œ!" 